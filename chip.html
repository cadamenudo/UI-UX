<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chip + Cola de Recordatorios</title>
  <link rel="stylesheet" href="https://cadamenudo.github.io/UI-UX/css-fonts.css"/>
  <style>
    body{margin:0; font-family:'Greycliff CF',system-ui,sans-serif; background:#f7f8fa; min-height:100vh;}

    /* === CHIP flotante === */
    .rem-chip{position:fixed; right:16px; bottom:24px; display:flex; align-items:center; gap:10px;
      background:#fff; border:1px solid #e5e7eb; border-radius:999px; padding:.55rem .9rem; font-weight:700;
      color:#111; box-shadow:0 10px 28px rgba(2,6,23,.18); cursor:pointer; z-index:20000;}
    .rem-chip .dot{width:12px; height:12px; border-radius:999px; background:#3956E8}
    .rem-chip .cnt{color:#3956E8; font-weight:800}

    /* Overlay + Modal */
    .rem-ovl{position:fixed; inset:0; background:rgba(2,6,23,.36); display:none; z-index:20001}
    .rem-ovl.show{display:block}
    .rem-modal{position:fixed; inset:0; display:grid; place-items:center; z-index:20002; pointer-events:none}
    .rem-modal.show .rem-sheet{transform:translateY(0); opacity:1}
    .rem-sheet{width:min(760px,calc(100% - 24px)); background:#fff; border-radius:16px; border:1px solid #e5e7eb;
      box-shadow:0 24px 80px rgba(2,6,23,.30); overflow:hidden; transform:translateY(10px); opacity:0;
      transition:transform .18s ease, opacity .18s ease; pointer-events:auto}
    .rem-hdr{display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:14px 16px; border-bottom:1px solid #e5e7eb}
    .rem-title{margin:0; font:700 1.05rem/1.2 system-ui, -apple-system, Segoe UI, Roboto}
    .rem-close{border:none; background:#f3f4f6; color:#374151; border-radius:10px; padding:.5rem .7rem; cursor:pointer}

    /* Lista con estilo tarjetas */
    .rem-body{padding:10px 12px 14px; max-height:70vh; overflow:auto; background:#f7f8fa}
    .rem-card{background:#fff; border:1px solid #e5e7eb; border-radius:14px; padding:12px;
      display:flex; align-items:center; justify-content:space-between; gap:10px; margin:10px 0;
      box-shadow:0 4px 14px rgba(2,6,23,.04)}
    .rem-left{display:flex; align-items:flex-start; gap:12px}
    .rem-dot{width:14px; height:14px; border-radius:999px; background:#7459D9; margin-top:6px; flex:0 0 auto}
    .rem-ttl{font-weight:800}
    .rem-meta{font-size:.85rem; color:#64748B}
    .rem-badges{display:flex; gap:6px; flex-wrap:wrap; margin-top:4px}
    .rem-badge{font-size:.75rem; padding:.15rem .5rem; border-radius:999px; border:1px solid #e5e7eb; color:#334155; background:#f9fafb}
    .rem-actions{display:flex; gap:6px}
    .rem-btn{border:1px solid #e5e7eb; background:#fff; padding:.45rem .6rem; border-radius:10px; cursor:pointer}
    .rem-btn.danger{border-color:#fecaca; color:#b91c1c}
  </style>
</head>
<body>

  <!-- CHIP -->
  <button id="remChip" class="rem-chip" aria-haspopup="dialog" aria-controls="remQueue">
    <span class="dot" aria-hidden="true"></span>
    <span id="chipTitle">Pagar AMEX</span>
    <span class="cnt" id="chipCnt">(+2)</span>
  </button>

  <!-- MODAL / COLA -->
  <div id="remOvl" class="rem-ovl" tabindex="-1"></div>
  <div id="remQueue" class="rem-modal" role="dialog" aria-modal="true" aria-labelledby="remTitle">
    <div class="rem-sheet">
      <div class="rem-hdr">
        <h3 id="remTitle" class="rem-title">Recordatorios para hoy</h3>
        <button class="rem-close" id="remClose">Cerrar</button>
      </div>
      <div class="rem-body" id="remList"></div>
    </div>
  </div>

  <script>
    // ===== Demo data (ordenados por hora, el primero define el chip) =====
    let REMS = [
      { id:'1', name:'Pagar AMEX', date:'2025-09-11', time:'09:00', type:'Factura',  recur:'Una vez' },
      { id:'2', name:'IBKR meeting', date:'2025-09-11', time:'14:00', type:'Personal', recur:'Semanal' },
      { id:'3', name:'Savings app meeting', date:'2025-09-11', time:'13:30', type:'Personal', recur:'Semanal' },
    ];

    // ===== Helpers =====
    function fmtTime(hm){
      const [h,m]=hm.split(':'); const d=new Date(); d.setHours(+h,+m,0,0);
      return d.toLocaleTimeString([], {hour:'numeric', minute:'2-digit'});
    }
    function sortByTime(arr){ return arr.slice().sort((a,b)=> a.time.localeCompare(b.time)); }

    // ===== Chip state =====
    function refreshChip(){
      const arr = sortByTime(REMS);
      const title = document.getElementById('chipTitle');
      const cnt   = document.getElementById('chipCnt');
      if(arr.length===0){
        title.textContent = 'Sin recordatorios';
        cnt.textContent = '';
        return;
      }
      title.textContent = arr[0].name;
      const extra = arr.length-1;
      cnt.textContent = extra>0 ? `(+${extra})` : '';
    }

    // ===== Render lista de la cola =====
    function renderQueue(){
      const wrap = document.getElementById('remList');
      wrap.innerHTML = '';
      sortByTime(REMS).forEach(r=>{
        const el = document.createElement('div');
        el.className = 'rem-card';
        el.innerHTML = `
          <div class="rem-left">
            <span class="rem-dot" aria-hidden="true"></span>
            <div>
              <div class="rem-ttl">${r.name}</div>
              <div class="rem-meta">${new Date().toLocaleDateString()} â€¢ ${fmtTime(r.time)}</div>
              <div class="rem-badges">
                <span class="rem-badge">${r.type}</span>
                <span class="rem-badge">${r.recur}</span>
              </div>
            </div>
          </div>
          <div class="rem-actions">
            <button class="rem-btn" data-act="edit"  data-id="${r.id}" title="Editar">âœŽ</button>
            <button class="rem-btn danger" data-act="del"   data-id="${r.id}" title="Eliminar">ðŸ—‘</button>
          </div>`;
        wrap.appendChild(el);
      });

      // wire actions
      wrap.querySelectorAll('.rem-btn').forEach(btn=>{
        btn.addEventListener('click', (e)=>{
          const id  = e.currentTarget.getAttribute('data-id');
          const act = e.currentTarget.getAttribute('data-act');
          if(act==='edit') onEdit(id);
          if(act==='del')  onDelete(id);
        });
      });
    }

    // ===== Acciones =====
    function onEdit(id){
      const i = REMS.findIndex(r=>r.id===id);
      if(i<0) return;
      const current = REMS[i].name;
      const name = prompt('Editar tÃ­tulo del recordatorio:', current);
      if(name===null) return;
      const trimmed = name.trim();
      if(!trimmed) return;
      REMS[i].name = trimmed;
      renderQueue();
      refreshChip();
    }

    function onDelete(id){
      const r = REMS.find(x=>x.id===id);
      if(!r) return;
      if(!confirm(`Â¿Eliminar "${r.name}"?`)) return;
      REMS = REMS.filter(x=>x.id!==id);
      renderQueue();
      refreshChip();
      // si vacÃ­a, cierra modal
      if(REMS.length===0) closeQueue();
    }

    // ===== Abrir / cerrar modal =====
    const chip  = document.getElementById('remChip');
    const ovl   = document.getElementById('remOvl');
    const modal = document.getElementById('remQueue');
    const closeBtn = document.getElementById('remClose');

    function openQueue(){
      renderQueue();
      ovl.classList.add('show');
      modal.classList.add('show');
      closeBtn.focus();
    }
    function closeQueue(){
      ovl.classList.remove('show');
      modal.classList.remove('show');
      chip.focus();
    }

    chip.addEventListener('click', openQueue);
    closeBtn.addEventListener('click', closeQueue);
    ovl.addEventListener('click', closeQueue);
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeQueue(); });

    // init
    refreshChip();
  </script>
</body>
</html>
